---------------------Understanding my data

-------------------SQL command to display every column in a table
SELECT *
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID
LIMIT 10;

----------Query to determine gender category
SELECT
DISTINCT gender 
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

----------Query to determine race category
SELECT
DISTINCT race
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

----------Query to derive province information
SELECT
DISTINCT province
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

----------Knowing the channels
SELECT
DISTINCT channel2
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

------------Knowing time and date
SELECT
DISTINCT RECORDDATE2
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

SELECT
TO_DATE(v.RECORDDATE2, 'YYYY/MM/DD HH24:MI') AS Record_date,
DAYNAME(TO_DATE(v.RECORDDATE2, 'YYYY/MM/DD HH24:MI')) AS day_name,
MONTHNAME(TO_DATE(v.RECORDDATE2, 'YYYY/MM/DD HH24:MI')) AS month_name,
TO_TIME(v.Recorddate2, 'YYYY/MM/DD HH24:MI') AS Viewer_time
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
    ON u.USERID = v.USERID;

------------SQL Aggregate Functions
-----------Query to determine age
SELECT 
MIN(age)
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

SELECT
MAX(age)
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

--------Syntax to count unique number of viewers
SELECT COUNT(DISTINCT u.USERID) AS unique_users
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

---------Syntax to count unique number of social_media_handle_users
SELECT COUNT(DISTINCT u.social_media_handle) AS social_media_handle_users
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

-----------Using SQL, the CASE statement return different values based on conditions.
SELECT
CASE
WHEN u.Race = 'W' THEN 'White'
WHEN u.Race = 'B' THEN 'Black'
WHEN u.Race = 'I' THEN 'Indian'
WHEN u.Race = 'C' THEN 'Coloured'
ELSE 'None'
END AS RaceStatus
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

SELECT
CASE
WHEN u.AGE BETWEEN 0 AND 12 THEN 'Kids'
WHEN u.AGE BETWEEN 13 AND 21 THEN 'Teens'
WHEN u.AGE BETWEEN 22 AND 35 THEN 'Youth'
WHEN u.AGE BETWEEN 36 AND 65 THEN 'Adult'
ELSE 'Senior'
END AS AgeGroup
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;

SELECT
CASE
WHEN TO_TIME(v.Recorddate2,'YYYY/MM/DD HH24:MI') BETWEEN TIME '00:00:00' AND TIME '11:59:59' THEN 'Morning'
WHEN TO_TIME(v.Recorddate2,'YYYY/MM/DD HH24:MI') BETWEEN TIME '12:00:00' AND TIME '14:59:59' THEN 'Afternoon'
WHEN TO_TIME(v.Recorddate2,'YYYY/MM/DD HH24:MI') BETWEEN TIME '15:00:00' AND TIME '17:59:59' THEN 'Late Afternoon'
WHEN TO_TIME(v.Recorddate2,'YYYY/MM/DD HH24:MI') BETWEEN TIME '18:00:00' AND TIME '19:59:59' THEN 'Evening'
ELSE 'Night'
END AS time_buckets
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID;
  

---------SQL command to Filter rows that are NULL 
SELECT
IFNULL(u.Gender, 'Unknown') AS GenderStatus,
IFNULL(u.Province, 'Unknown') AS ProvinceStatus,
IFNULL(u.Race, 'Unknown') AS RaceStatus,
IFNULL(v.channel2, 'Unknown') AS channelstatus
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID

----------checking duplicate rows

SELECT COUNT(*) AS duplicate_count
FROM BRIGHTTV_PROJECT.CHANNELS.USERS u
INNER JOIN BRIGHTTV_PROJECT.CHANNELS.VIEWER_RECORD v
ON u.USERID = v.USERID
HAVING COUNT(*) > 1;

